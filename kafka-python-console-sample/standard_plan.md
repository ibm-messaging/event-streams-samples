# IBM Message Hub Kafka Python console sample application: Standard Plan
This Python console application demonstrates how to connect to [IBM Message Hub](https://console.ng.bluemix.net/docs/services/MessageHub/index.html), send and receive messages using the [confluent-kafka-python](https://github.com/confluentinc/confluent-kafka-python) library. It also shows how to create and list topics using the Message Hub Admin REST API.

This tutorial will explain how to run the sample app in [IBM Cloud®](https://console.ng.bluemix.net/) using a Message Hub Service. It is also possible to host the application locally and still target your Message Hub Service running in IBM Cloud but that is not covered during this tutorial.

__Important Note__: This sample creates on your behalf a topic named `kafka-python-console-sample-topic` with one partition - this will incur a fee if the topic does not already exist on your account.

## Prerequisites
To build and run the sample, you must have the following:
* Install the [IBM Cloud CLI](https://console.bluemix.net/docs/cli/reference/bluemix_cli/download_cli.html)
* Provision a [Message Hub Service Instance](https://console.ng.bluemix.net/catalog/services/message-hub/) in [IBM Cloud®](https://console.ng.bluemix.net/)

## Overview
To deploy and run the sample:
* Setup your `manifest.yml` with your service details
* Use `ibmcloud cf push` to deploy the app to IBM Cloud®
* Check the app logs to see messages being produced and consumed

## Running the Sample (IBM Cloud®)
Open the `manifest.yml` file and rename the `"Message Hub-CHANGEME"` entry to that of your own Message Hub Service Instance name.

Connect to IBM Cloud® with the Cloud Foundry Command Line Interface, making sure you are in the same org and space as your service, and run the following command in the same directory as the `manifest.yml` file:
```shell
ibmcloud cf push
```

Once the app has has started, you can run: 
```
ibmcloud cf logs kafka-python-console-sample --recent
``` 

This will show the app producing and consuming messages.

## Sample Output
Below is a snippet of the output generated by the sample:

```
Kafka Endpoints: kafka01-prod01.messagehub.services.us-south.bluemix.net:9093
Admin REST Endpoint: https://kafka-admin-prod01.messagehub.services.us-south.bluemix.net:443
Creating the topic kafka-python-console-sample-topic with Admin REST API
{}
Admin REST Listing Topics:
[{"name":"kafka-python-console-sample-topic","partitions":1,"retentionMs":"86400000","markedForDeletion":false}]
This sample app will run until interrupted.
The producer has started
The consumer has started
Message produced, offset: 0
Message produced, offset: 2
No messages consumed
Message produced, offset: 3
No messages consumed
Message produced, offset: 4
Message consumed: topic=kafka-python-console-sample-topic, partition=0, offset=4, key=key, value=This is a test message #4
Message produced, offset: 5
No messages consumed
Message produced, offset: 6
Message consumed: topic=kafka-python-console-sample-topic, partition=0, offset=5, key=key, value=This is a test message #5
Message produced, offset: 7
No messages consumed
Message produced, offset: 8
Message consumed: topic=kafka-python-console-sample-topic, partition=0, offset=6, key=key, value=This is a test message #6
```

## Further references

If you are unfamiliar with Cloud Foundry applications or Liberty then you might find the following documents useful:

[Cloud Foundry manifest documentation](http://docs.cloudfoundry.org/devguide/deploy-apps/manifest.html)